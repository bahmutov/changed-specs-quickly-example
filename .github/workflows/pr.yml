name: PR checks
on: [pull_request]
jobs:
  changed-tests:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          # need to fetch info about all branches
          # to determine the changed spec files
          # https://glebbahmutov.com/blog/faster-ci-feedback/
          fetch-depth: 0

      - name: Install find-cypress-specs ğŸ“¦
        # https://github.com/bahmutov/npm-install
        uses: bahmutov/npm-install@v1
        with:
          # use just package.json checksum
          useLockFile: false
          install-command: 'npm install find-cypress-specs'

      - name: Trace changed specs
        # against the "master" branch
        # and including changed files imported by specs
        # https://github.com/bahmutov/find-cypress-specs
        id: trace
        run: npm run trace-changed-specs

      # - name: Run changed Cypress specs ğŸ
      #   if: ${{ steps.trace.outputs.changedSpecsN > 0 }}
      #   uses: cypress-io/github-action@v5
      #   with:
      #     # we have already installed all dependencies above
      #     install: false
      #     spec: ${{ steps.trace.outputs.changedSpecs }}
      #     # start the app before running the tests
      #     start: npm start
